<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Lintian::Util</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<script type="text/javascript" src="<script type="text/javascript" src="../_podly.js"></script>
"></script>
</head>
<body>


<ul id="index">
  <li><a href="#NAME">NAME</a></li>
  <li><a href="#SYNOPSIS">SYNOPSIS</a></li>
  <li><a href="#DESCRIPTION">DESCRIPTION</a></li>
  <li><a href="#VARIABLES">VARIABLES</a></li>
  <li><a href="#FUNCTIONS">FUNCTIONS</a></li>
  <li><a href="#SEE-ALSO">SEE ALSO</a></li>
</ul>

<h1 id="NAME">NAME</h1>

<p>Lintian::Util - Lintian utility functions</p>

<h1 id="SYNOPSIS">SYNOPSIS</h1>

<pre><code> use Lintian::Util;</code></pre>

<h1 id="DESCRIPTION">DESCRIPTION</h1>

<p>This module contains a number of utility subs that are nice to have, but on their own did not warrant their own module.</p>

<p>Most subs are imported only on request.</p>

<h1 id="VARIABLES">VARIABLES</h1>

<dl>

<dt>$PKGNAME_REGEX</dt>
<dd>

<p>Regular expression that matches valid package names. The expression is not anchored and does not enforce any &quot;boundary&quot; characters.</p>

</dd>
<dt>$PKGREPACK_REGEX</dt>
<dd>

<p>Regular expression that matches &quot;repacked&quot; package names. The expression is not anchored and does not enforce any &quot;boundary&quot; characters. It should only be applied to the upstream portion (see #931846).</p>

</dd>
<dt>$PKGVERSION_REGEX</dt>
<dd>

<p>Regular expression that matches valid package versions. The expression is not anchored and does not enforce any &quot;boundary&quot; characters.</p>

</dd>
</dl>

<h1 id="FUNCTIONS">FUNCTIONS</h1>

<dl>

<dt>drain_pipe(FD)</dt>
<dd>

<p>Reads and discards any remaining contents from FD, which is assumed to be a pipe. This is mostly done to avoid having the &quot;write&quot;-end die with a SIGPIPE due to a &quot;broken pipe&quot; (which can happen if you just close the pipe).</p>

<p>May cause an exception if there are issues reading from the pipe.</p>

<p>Caveat: This will block until the pipe is closed from the &quot;write&quot;-end, so only use it with pipes where the &quot;write&quot;-end will eventually close their end by themselves (or something else will make them close it).</p>

</dd>
<dt>get_file_digest(ALGO, FILE)</dt>
<dd>

<p>Creates an ALGO digest object that is seeded with the contents of FILE. If you just want the hex digest, please use <a href="#get_file_checksum-ALGO-FILE">&quot;get_file_checksum(ALGO, FILE)&quot;</a> instead.</p>

<p>ALGO can be &#39;md5&#39; or shaX, where X is any number supported by <a href="https://metacpan.org/pod/Digest::SHA">Digest::SHA</a> (e.g. &#39;sha256&#39;).</p>

<p>This sub is a convenience wrapper around Digest::{MD5,SHA}.</p>

</dd>
<dt>get_file_checksum(ALGO, FILE)</dt>
<dd>

<p>Returns a hexadecimal string of the message digest checksum generated by the algorithm ALGO on FILE.</p>

<p>ALGO can be &#39;md5&#39; or shaX, where X is any number supported by <a href="https://metacpan.org/pod/Digest::SHA">Digest::SHA</a> (e.g. &#39;sha256&#39;).</p>

<p>This sub is a convenience wrapper around Digest::{MD5,SHA}.</p>

</dd>
<dt>perm2oct(PERM)</dt>
<dd>

<p>Translates PERM to an octal permission. PERM should be a string describing the permissions as done by <i>tar t</i> or <i>ls -l</i>. That is, it should be a string like &quot;-rw-r--r--&quot;.</p>

<p>If the string does not appear to be a valid permission, it will cause a trappable error.</p>

<p>Examples:</p>

<pre><code> # Good
 perm2oct(&#39;-rw-r--r--&#39;) == oct(644)
 perm2oct(&#39;-rwxr-xr-x&#39;) == oct(755)

 # Bad
 perm2oct(&#39;broken&#39;)      # too short to be recognised
 perm2oct(&#39;-resurunet&#39;)  # contains unknown permissions</code></pre>

</dd>
<dt>human_bytes(SIZE)</dt>
<dd>

</dd>
<dt>locate_executable (CMD)</dt>
<dd>

</dd>
<dt>drop_relative_prefix(STRING)</dt>
<dd>

<p>Remove an initial ./ from STRING, if present</p>

</dd>
<dt>version_from_changelog</dt>
<dd>

</dd>
<dt>normalize_pkg_path(PATH)</dt>
<dd>

<p>Normalize PATH by removing superfluous path segments. PATH is assumed to be relative the package root. Note that the result will never start nor end with a slash, even if PATH does.</p>

<p>As the name suggests, this is a path &quot;normalization&quot; rather than a true path resolution (for that use Cwd::realpath). Particularly, it assumes none of the path segments are symlinks.</p>

<p>normalize_pkg_path will return <code>q{}</code> (i.e. the empty string) if PATH is normalized to the root dir and <code>undef</code> if the path cannot be normalized without escaping the package root.</p>

</dd>
<dt>normalize_link_target(CURDIR, LINK_TARGET)</dt>
<dd>

<p>Normalize the path obtained by following a link with LINK_TARGET as its target from CURDIR as the current directory. CURDIR is assumed to be relative to the package root. Note that the result will never start nor end with a slash, even if CURDIR or DEST does.</p>

<p>normalize_pkg_path will return <code>q{}</code> (i.e. the empty string) if the target is the root dir and <code>undef</code> if the path cannot be normalized without escaping the package root.</p>

<p><b>CAVEAT</b>: This function is <i>not always sufficient</i> to test if it is safe to open a given symlink. Use <code>is_ancestor_of(PARENTDIR, PATH)</code> for that. If you must use this function, remember to check that the target is not a symlink (or if it is, that it can be resolved safely).</p>

</dd>
<dt>is_ancestor_of(PARENTDIR, PATH)</dt>
<dd>

<p>Returns true if and only if PATH is PARENTDIR or a path stored somewhere within PARENTDIR (or its subdirs).</p>

<p>This function will resolve the paths; any failure to resolve the path will cause a trappable error.</p>

</dd>
<dt>read_md5sums</dt>
<dd>

</dd>
<dt>unescape_md5sum_filename</dt>
<dd>

</dd>
<dt>utf8_clean_log</dt>
<dd>

</dd>
<dt>utf8_clean_bytes</dt>
<dd>

</dd>
</dl>

<h1 id="SEE-ALSO">SEE ALSO</h1>

<p>lintian(1)</p>

<p class="backlinkbottom"><b><a name="___bottom" href="../index.html" title="All Documents">&lt;&lt;</a></b></p>


